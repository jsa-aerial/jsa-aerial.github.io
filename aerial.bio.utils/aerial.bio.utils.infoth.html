<!DOCTYPE html PUBLIC ""
    "">
<html><head><meta charset="UTF-8" /><title>aerial.bio.utils.infoth documentation</title><link rel="stylesheet" type="text/css" href="css/default.css" /><link rel="stylesheet" type="text/css" href="css/highlight.css" /><script type="text/javascript" src="js/highlight.min.js"></script><script type="text/javascript" src="js/jquery.min.js"></script><script type="text/javascript" src="js/page_effects.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body><div id="header"><h2>Generated by <a href="https://github.com/weavejester/codox">Codox</a></h2><h1><a href="index.html"><span class="project-title"><span class="project-name">Aerial.bio.utils</span> <span class="project-version">1.0.0</span></span></a></h1></div><div class="sidebar primary"><h3 class="no-link"><span class="inner">Project</span></h3><ul class="index-link"><li class="depth-1 "><a href="index.html"><div class="inner">Index</div></a></li></ul><h3 class="no-link"><span class="inner">Topics</span></h3><ul><li class="depth-1 "><a href="intro.html"><div class="inner"><span>Introduction to bio.utils</span></div></a></li></ul><h3 class="no-link"><span class="inner">Namespaces</span></h3><ul><li class="depth-1"><div class="no-link"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>aerial</span></div></div></li><li class="depth-2"><div class="no-link"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>bio</span></div></div></li><li class="depth-3"><div class="no-link"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>utils</span></div></div></li><li class="depth-4 branch"><a href="aerial.bio.utils.aligners.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>aligners</span></div></a></li><li class="depth-4 branch"><a href="aerial.bio.utils.extools.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>extools</span></div></a></li><li class="depth-4 branch"><a href="aerial.bio.utils.files.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>files</span></div></a></li><li class="depth-4 branch"><a href="aerial.bio.utils.filters.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>filters</span></div></a></li><li class="depth-4 branch current"><a href="aerial.bio.utils.infoth.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>infoth</span></div></a></li><li class="depth-4 branch"><a href="aerial.bio.utils.params.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>params</span></div></a></li><li class="depth-4"><a href="aerial.bio.utils.seqxform.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>seqxform</span></div></a></li></ul></div><div class="sidebar secondary"><h3><a href="#top"><span class="inner">Public Vars</span></a></h3><ul><li class="depth-1"><a href="aerial.bio.utils.infoth.html#var-aln-conditional-mutual-information"><div class="inner"><span>aln-conditional-mutual-information</span></div></a></li><li class="depth-1"><a href="aerial.bio.utils.infoth.html#var-aln-entropy"><div class="inner"><span>aln-entropy</span></div></a></li><li class="depth-1"><a href="aerial.bio.utils.infoth.html#var-aln-freqs-probs"><div class="inner"><span>aln-freqs-probs</span></div></a></li><li class="depth-1"><a href="aerial.bio.utils.infoth.html#var-aln-joint-entropy"><div class="inner"><span>aln-joint-entropy</span></div></a></li><li class="depth-1"><a href="aerial.bio.utils.infoth.html#var-aln-mutual-information"><div class="inner"><span>aln-mutual-information</span></div></a></li><li class="depth-1"><a href="aerial.bio.utils.infoth.html#var-aln-shannon-entropy"><div class="inner"><span>aln-shannon-entropy</span></div></a></li><li class="depth-1"><a href="aerial.bio.utils.infoth.html#var-bg-freqs"><div class="inner"><span>bg-freqs</span></div></a></li><li class="depth-1"><a href="aerial.bio.utils.infoth.html#var-bg-freqs-probs"><div class="inner"><span>bg-freqs-probs</span></div></a></li><li class="depth-1"><a href="aerial.bio.utils.infoth.html#var-bp-stats"><div class="inner"><span>bp-stats</span></div></a></li><li class="depth-1"><a href="aerial.bio.utils.infoth.html#var-degap-freqs"><div class="inner"><span>degap-freqs</span></div></a></li><li class="depth-1"><a href="aerial.bio.utils.infoth.html#var-degap-tuples"><div class="inner"><span>degap-tuples</span></div></a></li><li class="depth-1"><a href="aerial.bio.utils.infoth.html#var-seq-pairs-bpfreqs"><div class="inner"><span>seq-pairs-bpfreqs</span></div></a></li><li class="depth-1"><a href="aerial.bio.utils.infoth.html#var-seq-vi"><div class="inner"><span>seq-vi</span></div></a></li><li class="depth-1"><a href="aerial.bio.utils.infoth.html#var-seqs-freqs-probs"><div class="inner"><span>seqs-freqs-probs</span></div></a></li><li class="depth-1"><a href="aerial.bio.utils.infoth.html#var-seqs-shannon-entropy"><div class="inner"><span>seqs-shannon-entropy</span></div></a></li></ul></div><div class="namespace-docs" id="content"><h1 class="anchor" id="top">aerial.bio.utils.infoth</h1><div class="doc"><pre class="plaintext">Various information theory computations, calculations and results
as applied to bio sequences and alignments thereof.  Includes
entropy, joint entropy, conditional entropy, mutual information,
conditional mi, et. al.</pre></div><div class="public anchor" id="var-aln-conditional-mutual-information"><h3>aln-conditional-mutual-information</h3><div class="usage"><code>(aln-conditional-mutual-information seqset &amp; {par :par, nogaps :nogaps, pgap :pgap, cols :cols, norm :norm, sym? :sym?, :or {par 1, nogaps true, pgap 0.25, cols true, norm true, sym? true}})</code></div><div class="doc"><pre class="plaintext">Mutual information of all 2 column pairs in an alignment
conditioned by the residual - unordered - bases of the remaining
columns.  Let colpairs be (combins 2 (transpose aln)).  For any
pair of columns [X Y] in colpairs, let Z be colpairs - {X Y}.
Compute I(X;Y|Z), the mutual information for X&amp;Y given Z.
</pre></div></div><div class="public anchor" id="var-aln-entropy"><h3>aln-entropy</h3><div class="usage"><code>(aln-entropy n seqset &amp; args)</code></div><div class="doc"><pre class="plaintext">Compute the entropy of each column Ci of an alignment given in SEQSET,
a gaisr-seq-set.  Entropy is based on the freqs and probs of
elements of Ci taken n at a time.  ARGS are any keyword arguments
taken by aln-freqs-probs.

The manner of taking the elements is determined by the fsps-fn
argument of aln-freqs-probs.  The default for this,
cc-combins-freqs-probs is based on the combins function, which
generates all n-element subsets of Ci.  cc-freqs-probs is based on
freqn which generates the sliding window of n elements from Ci.

Returns [cols-entropies total-entropy tcnt], where

cols-entropies is a seq of entropies for each Ci
total-entropy is the total entropy over all the columns (from total probs)
tcnt is the total over all columns of elements counted
</pre></div></div><div class="public anchor" id="var-aln-freqs-probs"><h3>aln-freqs-probs</h3><div class="usage"><code>(aln-freqs-probs n seqset &amp; {:keys [fsps-fn cols nogaps norm pgap par], :or {fsps-fn cc-combins-freqs-probs, cols false, nogaps true, norm true, pgap 0.7, par 1}})</code></div><div class="doc"><pre class="plaintext">Take the sequences in SEQSET, a collection of sequences or a string
denoting a legal format sequence file (see read-seqs), treat as a
matrix M encoding an alignment (and so all seqs in set must have
equal length).  If NORM, normalize all base characters to uppercase
in M.  PGAP is the percent of gaps cutoff for columns.  Filter M,
by removing all columns Ci, (&gt; (gap-percent Ci) pgap) to get M'.

Uses FSPS-FN, a function taking a combination count or window width
of N and a sequence collection, to compute the frequencies and
probabilities of columns Ci in M' by means of seqs-freqs-probs.
Let Ci-fs-ps be the results for Ci.  Typically such a result would
be a triple [fs ps cnt], where fs and ps are maps of frequencies
and corresponding probabilities keyed by the n-tuple of bases (and
possibly gaps) underlying fsps-fn (see, for example,
cc-freqs-probs).

If NOGAPS is true, remove all items with gaps from maps and
recompute new probabilities for resulting reduced frequencies sets.

For large (count seqset) with expensive fss-fn, use par to
parallelize computation over par chunks.

Returns [ccfs&amp;ps allfs allps tcount], where

ccfs&amp;ps is the seq Ci-fs-ps calculated from M'
allfs is the map of freqs obtained by reducing over all Ci-fs maps
allps is the map of probs obtained by reducing over all Ci-ps maps
tcount is the total item (obtained n-tuples) count.
</pre></div></div><div class="public anchor" id="var-aln-joint-entropy"><h3>aln-joint-entropy</h3><div class="usage"><code>(aln-joint-entropy seqset &amp; args)</code></div><div class="doc"><pre class="plaintext">Application of aln-entropy with cc-combins-freqs-probs and n=2.
So, joint entropy of each column with itself and overall totals.
</pre></div></div><div class="public anchor" id="var-aln-mutual-information"><h3>aln-mutual-information</h3><div class="usage"><code>(aln-mutual-information seqset &amp; {:keys [par nogaps pgap cols norm sym?], :or {par 1, nogaps true, pgap 0.25, cols false, norm true, sym? true}})</code></div><div class="doc"><pre class="plaintext">
</pre></div></div><div class="public anchor" id="var-aln-shannon-entropy"><h3>aln-shannon-entropy</h3><div class="usage"><code>(aln-shannon-entropy seqset &amp; args)</code></div><div class="doc"><pre class="plaintext">Application of aln-entropy with cc-freqs-probs and n=1.  So,
shannon entropy of each column and totals over all columns.
</pre></div></div><div class="public anchor" id="var-bg-freqs"><h3>bg-freqs</h3><div class="usage"><code>(bg-freqs n filespecs &amp; {:keys [fsps-fn ftypes dirdir cols sym? nogaps norm par], :or {fsps-fn cc-freqs-probs, ftypes [".sto"], dirdir false, cols false, sym? false, mnogaps false, norm true, par 1}})</code></div><div class="doc"><pre class="plaintext">Perform a bacground frequency distribution calculation over the
sequences in FILESPECS (a coll of legal format sequence files or a
directory of such or if dirdir is true, a directory of directories
of such, see read-seqs).  FTYPES gives the file types in the cases
where filespecs is a dir or dirdir.

By default, the distributions are performed with a sliding window
of N length.  So, on DNA/RNA sequences 1 gives base probabilities,
2 gives a dinucleotide distribution, etc.  To change this supply a
different freq&amp;prob calculation function for fsps-fn.  For more
information see seqs-freqs-probs description.

If cols is true, computation is over the columns of the sequences.
if sym? is true, treat reversable keys as equal.
If nogaps is true, removes default gap characters from calculation.
If nogaps is a coll (for example, (keys +NONSTD-RNA+)), removes all
those characters from calculation.  If norm is true, normalize
characters to upper case.
</pre></div></div><div class="public anchor" id="var-bg-freqs-probs"><h3>bg-freqs-probs</h3><div class="usage"><code>(bg-freqs-probs n filespecs &amp; {:keys [fsps-fn ftypes dirdir cols sym? nogaps norm par], :or {fsps-fn cc-freqs-probs, ftypes [".sto"], dirdir false, cols false, sym? false, nogaps false, norm true, par 1}})</code></div><div class="doc"><pre class="plaintext">Like bg-freqs, but with the additional final computation of
probability distribution for the frequency distribution
</pre></div></div><div class="public anchor" id="var-bp-stats"><h3>bp-stats</h3><div class="usage"><code>(bp-stats bp-freq-map)</code></div><div class="doc"><pre class="plaintext"></pre></div></div><div class="public anchor" id="var-degap-freqs"><h3>degap-freqs</h3><div class="usage"><code>(degap-freqs freq-map)</code><code>(degap-freqs freq-map gap-chars)</code></div><div class="doc"><pre class="plaintext">Take a frequency map, and remove all elements whose keys contain
gap characters.  Gap chars are either the defaults \. \- or those
in gap-chars (a seqable collection).
</pre></div></div><div class="public anchor" id="var-degap-tuples"><h3>degap-tuples</h3><div class="usage"><code>(degap-tuples tuple-of-sqs)</code><code>(degap-tuples tuple-of-sqs gap-chars)</code></div><div class="doc"><pre class="plaintext">Remove gap characters from a tuple of sequences.  Typically this is
 a pair of sequences (as for example arising from (combins 2
 some-seq-set)).  The degaping works for gaps in any (through all)
 of the elements and preserves the correct bases and their order in
 cases where gaps line up with non gaps.  Gap chars are either the
 defaults \. \- or those in gap-chars (a seqable collection).

 EX:

 (degap-tuples
   ["CAAAUAAAAUAUAAUUUUAUAAUAAUAAGAAUAUAUAAAAAAUAUUAUAUAAAAGAAA"
    "GGGAGGGGGGGGGGG-GGGGG-GGAGGGGGGG--GGGG-GGGGGAGG-GGGG-GGGG-"])
=&gt; ("CAAAUAAAAUAUAAUUUAUAUAAUAAGAAUAUAAAAAUAUUAAUAAAGAA"
    "GGGAGGGGGGGGGGGGGGGGGGAGGGGGGGGGGGGGGGGAGGGGGGGGGG")
</pre></div></div><div class="public anchor" id="var-seq-pairs-bpfreqs"><h3>seq-pairs-bpfreqs</h3><div class="usage"><code>(seq-pairs-bpfreqs seq-pairs &amp; {:keys [nogaps sym? par], :or {nogaps true, sym? true, par 4}})</code></div><div class="doc"><pre class="plaintext"></pre></div></div><div class="public anchor" id="var-seq-vi"><h3>seq-vi</h3><div class="usage"><code>(seq-vi seqx seqy &amp; {nogaps :nogaps, :or {nogaps true}})</code></div><div class="doc"><pre class="plaintext"></pre></div></div><div class="public anchor" id="var-seqs-freqs-probs"><h3>seqs-freqs-probs</h3><div class="usage"><code>(seqs-freqs-probs n seqset &amp; {:keys [fsps-fn nogaps norm par], :or {fsps-fn cc-freqs-probs, nogaps true, norm true, par 1}})</code></div><div class="doc"><pre class="plaintext">Return sequence frequencies and probabilities over the set of
sequences in SEQSET, a collection of sequences or a string denoting
a legal format sequence file (see read-seqs).  FSPS-FN is a
function taking a combination count or window width of N and a
sequence collection (here, seqset) and optional par parameter.
Applies fsps-fn to n and seqset.

For large (count seqset) with expensive fss-fn, use par to
parallelize computation over par chunks.

Return [ccfsps allfs allps tcount], where

ccfs&amp;ps is a seq of triples [fs ps cnt], for each C in seqset,
allfs is the map of freqs over all Cs,
allps is the map of probs over all Cs and
tcount is the total items over coll.

NOTE: item keys are "stringified", i.e., if k is a key from a map
produced by fsps-fn, ensures that all returned maps use (apply str
k) for all keys.
</pre></div></div><div class="public anchor" id="var-seqs-shannon-entropy"><h3>seqs-shannon-entropy</h3><div class="usage"><code>(seqs-shannon-entropy seqset)</code></div><div class="doc"><pre class="plaintext">Returns the Shannon entropy of the set of sequences in SEQSET, a
collection of sequences or a string denoting a legal format
sequence file (see read-seqs).  Returns a pair [ses total-ses],
where

ses is (map shannon-entropy seqset) and total-ses is the total over
all of seqset.
</pre></div></div></div></body></html>