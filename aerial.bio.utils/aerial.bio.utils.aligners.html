<!DOCTYPE html>
<html><head><meta charset="UTF-8"><link href="css/default.css" rel="stylesheet" type="text/css"><script src="js/jquery.min.js" type="text/javascript"></script><script src="js/page_effects.js" type="text/javascript"></script><title>aerial.bio.utils.aligners documentation</title></head><body><div id="header"><h2>Generated by <a href="https://github.com/weavejester/codox">Codox</a></h2><h1><a href="index.html"><span class="project-title"><span class="project-name">Aerial.bio.utils</span> <span class="project-version">2.0.0</span></span></a></h1></div><div class="sidebar primary"><ul class="index-link"><li class="depth-1 "><a href="index.html"><div class="inner">Index</div></a></li></ul><h3 class="no-link"><span class="inner">Topics</span></h3><ul><li class="depth-1 "><a href="intro.html"><div class="inner"><span>Introduction to bio.utils</span></div></a></li></ul><h3 class="no-link"><span class="inner">Namespaces</span></h3><ul><li class="depth-1"><div class="no-link"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>aerial</span></div></div></li><li class="depth-2"><div class="no-link"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>bio</span></div></div></li><li class="depth-3"><div class="no-link"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>utils</span></div></div></li><li class="depth-4 branch current"><a href="aerial.bio.utils.aligners.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>aligners</span></div></a></li><li class="depth-4 branch"><a href="aerial.bio.utils.extools.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>extools</span></div></a></li><li class="depth-4 branch"><a href="aerial.bio.utils.files.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>files</span></div></a></li><li class="depth-4 branch"><a href="aerial.bio.utils.filters.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>filters</span></div></a></li><li class="depth-4 branch"><a href="aerial.bio.utils.infoth.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>infoth</span></div></a></li><li class="depth-4 branch"><a href="aerial.bio.utils.params.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>params</span></div></a></li><li class="depth-4"><a href="aerial.bio.utils.seqxform.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>seqxform</span></div></a></li></ul></div><div class="sidebar secondary"><h3><a href="#top"><span class="inner">Public Vars</span></a></h3><ul><li class="depth-1"><a href="aerial.bio.utils.aligners.html#var-align"><div class="inner"><span>align</span></div></a></li><li class="depth-1"><a href="aerial.bio.utils.aligners.html#var-decode-trace-back"><div class="inner"><span>decode-trace-back</span></div></a></li><li class="depth-1"><a href="aerial.bio.utils.aligners.html#var-deep-aget"><div class="inner"><span>deep-aget</span></div></a></li><li class="depth-1"><a href="aerial.bio.utils.aligners.html#var-deep-aset"><div class="inner"><span>deep-aset</span></div></a></li><li class="depth-1"><a href="aerial.bio.utils.aligners.html#var-do-col"><div class="inner"><span>do-col</span></div></a></li><li class="depth-1"><a href="aerial.bio.utils.aligners.html#var-do-row"><div class="inner"><span>do-row</span></div></a></li><li class="depth-1"><a href="aerial.bio.utils.aligners.html#var-hirsch-align"><div class="inner"><span>hirsch-align</span></div></a></li><li class="depth-1"><a href="aerial.bio.utils.aligners.html#var-hirsch-align-recur"><div class="inner"><span>hirsch-align-recur</span></div></a></li><li class="depth-1"><a href="aerial.bio.utils.aligners.html#var-lcsubseq"><div class="inner"><span>lcsubseq</span></div></a></li><li class="depth-1"><a href="aerial.bio.utils.aligners.html#var-lcsubstg"><div class="inner"><span>lcsubstg</span></div></a></li><li class="depth-1"><a href="aerial.bio.utils.aligners.html#var-nt4submat"><div class="inner"><span>nt4submat</span></div></a></li></ul></div><div class="namespace-docs" id="content"><h1 class="anchor" id="top">aerial.bio.utils.aligners</h1><div class="doc"><pre class="plaintext">Various sequence aligners by means of low level hackery...
</pre></div><div class="public anchor" id="var-align"><h3>align</h3><div class="usage"><code>(align s1 s2 &amp; {:keys [kind submat gap match mmatch decode keep-scmat], :or {kind :global, gap -2, decode true, keep-scmat false}})</code></div><div class="doc"><pre class="plaintext">Align s1 and s2 (strings) in the manner defined by kind:

:global - Standard NW global alignment
:ends-gap-free - global aln without gaps on ends (prefix/suffix aln)
:local - Standard SW alignment

submat is a substitution map (matrix) giving a score for a character
pair. This namespace provides nt4submat which encodes a &apos;standard&apos;
ATGCxATGC substitution matrix.

match is a score for the case when characters match (they are =)
mmatch is a penalty score for the case when characters do not match

submat and match/mmmatch are mutually exclusive

gap is a penalty score for indels (characters match a gap)

keep-scmat is a boolean for whether to return the scoring
matrix (true) or not (false)

Returns the traceback path of best alignment as a vector of
triples: [dir score [i j]], where dir is the direction to get this
point of path (:d -&gt; diagonal, :u -&gt; up, :l -&gt; left), score is the
score at this point, and [i j] is the index pair for s1 and s2 of
this point (i for s1, j for s2) 0-based.

If decode is true (default), tb is returned as the pair of aligned
strings (with gaps if needed)

If keep-scmat is true, returns a vector [tb scmat] otherwise returns
just tb, tb the traceback.
</pre></div></div><div class="public anchor" id="var-decode-trace-back"><h3>decode-trace-back</h3><div class="usage"><code>(decode-trace-back s1 s2 tbk)</code></div><div class="doc"><pre class="plaintext"></pre></div></div><div class="public anchor" id="var-deep-aget"><h3>deep-aget</h3><h4 class="type">macro</h4><div class="usage"><code>(deep-aget hint array idx)</code><code>(deep-aget hint array idx &amp; idxs)</code></div><div class="doc"><pre class="plaintext"></pre></div></div><div class="public anchor" id="var-deep-aset"><h3>deep-aset</h3><h4 class="type">macro</h4><div class="usage"><code>(deep-aset hint array &amp; idxsv)</code></div><div class="doc"><pre class="plaintext"></pre></div></div><div class="public anchor" id="var-do-col"><h3>do-col</h3><h4 class="type">macro</h4><div class="usage"><code>(do-col scmat col e &amp; body)</code></div><div class="doc"><pre class="plaintext"></pre></div></div><div class="public anchor" id="var-do-row"><h3>do-row</h3><h4 class="type">macro</h4><div class="usage"><code>(do-row scmat row e &amp; body)</code></div><div class="doc"><pre class="plaintext"></pre></div></div><div class="public anchor" id="var-hirsch-align"><h3>hirsch-align</h3><div class="usage"><code>(hirsch-align sx sy &amp; {:keys [kind submat gap match mmatch with-score? score-only?], :or {kind :global, gap -2, with-score? true}})</code></div><div class="doc"><pre class="plaintext"></pre></div></div><div class="public anchor" id="var-hirsch-align-recur"><h3>hirsch-align-recur</h3><div class="usage"><code>(hirsch-align-recur sx sy &amp; {:keys [kind submat gap match mmatch]})</code></div><div class="doc"><pre class="plaintext"></pre></div></div><div class="public anchor" id="var-lcsubseq"><h3>lcsubseq</h3><div class="usage"><code>(lcsubseq s1 s2)</code></div><div class="doc"><pre class="plaintext"></pre></div></div><div class="public anchor" id="var-lcsubstg"><h3>lcsubstg</h3><div class="usage"><code>(lcsubstg s1 s2)</code></div><div class="doc"><pre class="plaintext"></pre></div></div><div class="public anchor" id="var-nt4submat"><h3>nt4submat</h3><div class="usage"></div><div class="doc"><pre class="plaintext"></pre></div></div></div></body></html>